#####################################
# This script runs tephra2-inversion
# and additional plotting scripts
# to visualize the results. Any line
# can be commented out with a # sign.
#####################################
#Path to the inversion code (example shown)
EXE=/home/bin/tephra2012_inversion
echo $EXE
#
INPUT=
echo $INPUT
#
#Selected wind field 
WIND=
#
echo $WIND
#
#Inversion configuration file
ICONF=
echo $ICONF
#
#Grid file for final forward model
GRID=
echo $GRID
###############################
date
# Do the inversion (example shown)
RUN="mpirun -np 4 -hostfile machines $EXE $ICONF $INPUT"
echo $RUN
$RUN
date
#
# Generate a plot of the plume model (beta function)
RUN="perl ../tephra2/scripts/plume.gmt.pl plume.dat plume.eps"
echo $RUN
$RUN
#
# Plot equiline plot (calculated vs. observed)
RUN="perl ../tephra2/scripts/in_vs_out.gmt.pl $INPUT in_vs_out.eps"
echo $RUN
$RUN
#
# Write out a configuration file for tephra2
#perl ../tephra2/scripts/write_conf.pl parameters.README tephra2.conf 400 400 nrmse
#
# Generate a wind diagram
RUN="perl ../tephra2/scripts/psrose.gmt.pl wind_levels.out psrose.in psrose0.eps"
echo $RUN
$RUN
#
# Run the tephra2 forward model
RUN="/home/ljc/src/tephra2_inversion/2012.12.18/tephra2-2012 tephra2.conf $GRID wind_levels.out >tephra2.out"
echo $RUN
$RUN
#
# Parse the output data and create a plotting file
RUN="perl ../parse_tephra.out.pl tephra2.out > tephra2.out.xyz"
echo $RUN
$RUN
#
# Plot a contour map of the tephra deposit from tephra2 model
RUN="perl ../plot_tephra_contours.gmt.pl $INPUT tephra2.out.xyz contours.eps"
echo $RUN
$RUN
